<div *ngIf="commission$ | async as commission; else loader">
    <div *ngIf="character$ | async as character; else loader">
        <div class="chat-warning">
            {{'COMMISSION_BOARD.Chat_warning' | translate}}
        </div>
        <div class="chat-container">
            <div class="sidebar" *ngIf="commission.authorId === character.userId">
                <mat-list>
                    <mat-list-item *ngFor="let discussion of commission.discussions">
                        <div *ngIf="userService.getCharacter(discussion.crafterId) | async as crafter">
                            <img [src]="crafter.avatar" alt="" mat-list-avatar>
                            <span matLine>{{crafter.name}}</span>
                        </div>
                    </mat-list-item>
                </mat-list>
            </div>
            <div class="chat-content" *ngIf="discussion$ | async as discussion">
                <div class="message" *ngFor="let message of discussion.messages">
                    {{message.content}}
                </div>
            </div>
        </div>
        <div class="chat-box" *ngIf="discussion$ | async as discussion">
            <form (submit)="sendMessage(commission, discussion, character.userId)">
                <mat-form-field>
                    <textarea matInput name="message" cols="150" rows="3" [(ngModel)]="message"></textarea>
                </mat-form-field>
                <button mat-button type="submit" class="send-button">
                    <mat-icon>send</mat-icon>
                </button>
            </form>
        </div>
    </div>
</div>
<ng-template #loader>
    <div class="loader-container">
        <mat-spinner></mat-spinner>
    </div>
</ng-template>
