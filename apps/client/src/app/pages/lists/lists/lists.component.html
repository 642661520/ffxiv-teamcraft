<app-page-loader *ngIf="loading$ | async; else lists">
</app-page-loader>
<ng-template #lists>
  <div *ngIf="lists$ | async as lists">
    <div class="toolbar" fxLayout="row wrap" fxLayoutGap="5px">
      <button nz-button [nzShape]="'circle'" [nzType]="'primary'" (click)="createList()" nz-tooltip
              [nzTitle]="'New_List' | translate">
        <i nz-icon type="file-add"></i>
      </button>
      <button nz-button [nzShape]="'circle'" [nzType]="'primary'" (click)="createWorkshop()" nz-tooltip
              [nzTitle]="'WORKSHOP.Add_workshop' | translate">
        <i nz-icon type="folder-add"></i>
      </button>
      <div class="spacer">
      </div>
      <button nz-button nzType="primary" nzShape="circle" nz-tooltip
              [nzTitle]="'LISTS.Regenerate_all' | translate" (click)="regenerateLists(lists)">
        <i class="material-icons">update</i>
      </button>
    </div>
    <h2>{{'LISTS.Your_lists' | translate}}</h2>
    <div class="ngx-dnd-container" ngxDroppable="list"
         (drop)="setListIndex($event.value, $event.dropIndex, lists)">
      <div class="ngx-dnd-item list-panel" *ngFor="let list of lists.otherLists; trackBy: trackByList"
           ngxDraggable="list"
           [model]="list">
        <app-list-panel [list]="list"></app-list-panel>
      </div>
      <app-fullpage-message *ngIf="lists.length === 0 && !(loading | async)" height="150px">
        {{'LISTS.No_lists' | translate}}
      </app-fullpage-message>
    </div>
    <nz-divider></nz-divider>
    <nz-collapse *ngIf="lists.communityLists.length > 0">
      <nz-collapse-panel nzHeader="{{'Your_public_lists' | translate}} ({{lists.communityLists.length}})">
        <div class="ngx-dnd-container" ngxDroppable="communityList"
             (drop)="setListIndex($event.value, $event.dropIndex, lists)">
          <div class="ngx-dnd-item list-panel" *ngFor="let list of lists.communityLists; trackBy: trackByList"
               ngxDraggable="communityList"
               [model]="list">
            <app-list-panel [list]="list"></app-list-panel>
          </div>
          <app-fullpage-message *ngIf="lists.length === 0 && !(loading | async)" height="150px">
            {{'LISTS.No_lists' | translate}}
          </app-fullpage-message>
        </div>
      </nz-collapse-panel>
    </nz-collapse>
  </div>
  <div *ngIf="listsWithWriteAccess$ | async as listsWithWriteAccess">
    <div *ngIf="listsWithWriteAccess.length > 0">
      <h2>{{'LISTS.Shared_lists' | translate}}</h2>
      <div class="list-panel" *ngFor="let list of listsWithWriteAccess; trackBy: trackByList">
        <app-list-panel [list]="list"></app-list-panel>
      </div>
    </div>
  </div>
  <div *ngIf="workshops$ | async as workshops">
    <div *ngIf="workshops.length > 0">
      <h2>{{'WORKSHOP.Workshops' | translate}}</h2>
      <div class="ngx-dnd-container" (drop)="setWorkshopIndex($event.value, $event.dropIndex, workshops)"
           ngxDroppable="workshop">
        <div class="ngx-dnd-item workshop-panel" *ngFor="let workshopDisplay of workshops; trackBy: trackByList"
             ngxDraggable="workshop" [model]="workshopDisplay.workshop">
          <app-workshop-panel [workshop]="workshopDisplay.workshop"
                              [lists]="workshopDisplay.lists"></app-workshop-panel>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="workshopsWithWriteAccess$ | async as workshopsWithWriteAccess">
    <div *ngIf="workshopsWithWriteAccess.length > 0">
      <h2>{{'WORKSHOP.Shared_workshops' | translate}}</h2>
      <div class="workshop-panel" *ngFor="let workshopDisplay of workshopsWithWriteAccess; trackBy: trackByList">
        <app-workshop-panel [workshop]="workshopDisplay.workshop" [lists]="workshopDisplay.lists"></app-workshop-panel>
      </div>
    </div>
  </div>
</ng-template>
